<html>
<head>
	<style>
		table, td {
		border: 1px solid black;
		width 10px;
		}
	</style>
</head>
<body>
	<table>
	<tr>
	<td><canvas width = "250" height="250" id="Empty"name="1" onclick="clickEventHandler(1)"></td>
    <td><canvas width = "250" height="250"  id="Empty"name="2"onclick="clickEventHandler(2)"></td>
	<td><canvas width = "250" height="250"  id="Empty"name="3"onclick="clickEventHandler(3)"></td>
	<td><canvas width = "250" height="250"  id="Empty"name="4"onclick="clickEventHandler(4)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="5"onclick="clickEventHandler(5)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="6"onclick="clickEventHandler(6)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="7"onclick="clickEventHandler(7)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="8"onclick="clickEventHandler(8)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="9"onclick="clickEventHandler(9)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="10"onclick="clickEventHandler(10)"></td>
  </tr>
  <tr>
	<td><canvas width = "250" height="250" id="Empty"name="11"onclick="clickEventHandler(11)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="12"onclick="clickEventHandler(12)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="13"onclick="clickEventHandler(13)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="14"onclick="clickEventHandler(14)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="15"onclick="clickEventHandler(15)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="16"onclick="clickEventHandler(16)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="17"onclick="clickEventHandler(17)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="18"onclick="clickEventHandler(18)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="19"onclick="clickEventHandler(19)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="20"onclick="clickEventHandler(20)"></td>
  </tr>
  <tr>
	<td><canvas width = "250" height="250" id="Empty"name="21"onclick="clickEventHandler(21)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="22"onclick="clickEventHandler(22)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="23"onclick="clickEventHandler(23)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="24"onclick="clickEventHandler(24)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="25"onclick="clickEventHandler(25)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="26"onclick="clickEventHandler(26)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="27"onclick="clickEventHandler(27)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="28"onclick="clickEventHandler(28)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="29"onclick="clickEventHandler(29)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="30"onclick="clickEventHandler(30)"></td>
  </tr>
  <tr>
	<td><canvas width = "250" height="250" id="Empty"name="31"onclick="clickEventHandler(31)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="32"onclick="clickEventHandler(32)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="33"onclick="clickEventHandler(33)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="34"onclick="clickEventHandler(34)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="35"onclick="clickEventHandler(35)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="36"onclick="clickEventHandler(36)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="37"onclick="clickEventHandler(37)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="38"onclick="clickEventHandler(38)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="39"onclick="clickEventHandler(39)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="40"onclick="clickEventHandler(40)"></td>
  </tr>
  <tr>
	<td><canvas width = "250" height="250" id="Empty"name="41"onclick="clickEventHandler(41)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="42"onclick="clickEventHandler(42)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="43"onclick="clickEventHandler(43)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="44"onclick="clickEventHandler(44)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="45"onclick="clickEventHandler(45)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="46"onclick="clickEventHandler(46)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="47"onclick="clickEventHandler(47)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="48"onclick="clickEventHandler(48)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="49"onclick="clickEventHandler(49)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="50"onclick="clickEventHandler(50)"></td>
  </tr>
  <tr>
	<td><canvas width = "250" height="250" id="Empty"name="51"onclick="clickEventHandler(51)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="52"onclick="clickEventHandler(52)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="53"onclick="clickEventHandler(53)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="54"onclick="clickEventHandler(54)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="55"onclick="clickEventHandler(55)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="56"onclick="clickEventHandler(56)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="57"onclick="clickEventHandler(57)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="58"onclick="clickEventHandler(58)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="59"onclick="clickEventHandler(59)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="60"onclick="clickEventHandler(60)"></td>
  </tr>
  <tr>
	<td><canvas width = "250" height="250" id="Empty"name="61"onclick="clickEventHandler(61)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="62"onclick="clickEventHandler(62)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="63"onclick="clickEventHandler(63)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="64"onclick="clickEventHandler(64)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="65"onclick="clickEventHandler(65)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="66"onclick="clickEventHandler(66)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="67"onclick="clickEventHandler(67)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="68"onclick="clickEventHandler(68)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="69"onclick="clickEventHandler(69)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="70"onclick="clickEventHandler(70)"></td>
  </tr>
  <tr>
	<td><canvas width = "250" height="250" id="Empty"name="71"onclick="clickEventHandler(71)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="72"onclick="clickEventHandler(72)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="73"onclick="clickEventHandler(73)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="74"onclick="clickEventHandler(74)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="75"onclick="clickEventHandler(75)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="76"onclick="clickEventHandler(76)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="77"onclick="clickEventHandler(77)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="78"onclick="clickEventHandler(78)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="79"onclick="clickEventHandler(79)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="80"onclick="clickEventHandler(80)"></td>
  </tr>
  <tr>
	<td><canvas width = "250" height="250" id="Empty"name="81"onclick="clickEventHandler(81)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="82"onclick="clickEventHandler(82)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="83"onclick="clickEventHandler(83)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="84"onclick="clickEventHandler(84)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="85"onclick="clickEventHandler(85)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="86"onclick="clickEventHandler(86)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="87"onclick="clickEventHandler(87)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="88"onclick="clickEventHandler(88)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="89"onclick="clickEventHandler(89)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="90"onclick="clickEventHandler(90)"></td>
  </tr>
  <tr>
	<td><canvas width = "250" height="250" id="Empty"name="91"onclick="clickEventHandler(91)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="92"onclick="clickEventHandler(92)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="93"onclick="clickEventHandler(93)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="94"onclick="clickEventHandler(94)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="95"onclick="clickEventHandler(95)"></td>
    <td><canvas width = "250" height="250" id="Empty"name="96"onclick="clickEventHandler(96)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="97"onclick="clickEventHandler(97)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="98"onclick="clickEventHandler(98)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="99"onclick="clickEventHandler(99)"></td>
	<td><canvas width = "250" height="250" id="Empty"name="100"onclick="clickEventHandler(100)"></td>
  </tr>
  </table>
  <br>
  <input type="button" value="Download"id="download">
  <input type="file" value="RecallFromFile"id="File">
  <script>
	
	// global variables 
	var canvas,context;
	var url;
	var urls = new Array();
	var image;
	var images = new Array();
	var i,name;
	var deleteImage;
	
	var input = document.getElementById("File");
	
	input.addEventListener("change", function () {
	if (this.files && this.files[0]) {
		var myFile = this.files[0];
		var reader = new FileReader();
		var row,col,index=0;
		reader.addEventListener('load', function (e) {
			var table_contents = e.target.result.split(",");
			alert(table_contents);
			updateTable();
    });
    
    reader.readAsText(myFile);
  }   
});

	var filename,text,name;
	document.getElementById("download").addEventListener("click", function(){
		
		text = generate_text();
		name = prompt("What do you want to name the file?");
		filename = name.concat(".txt");
    
    download(filename, text);
	}, false);
	
	function download(filename, text) {
		var element = document.createElement('a');
		element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
		element.setAttribute('download', filename);

		element.style.display = 'none';
		document.body.appendChild(element);

		element.click();

		document.body.removeChild(element);
	}

	
	function generate_text(){

		var text="";
		
		for (name=1;name<=100;name++){
			for(i=0;i<=images.length-1;i++){
				
				if(images[i][1] == name.toString()){
					text+=images[i][0].src.toString()+",";
				}
			}
		}
		return text;
	
	}
	
	function clickEventHandler(name){
		
		canvas = document.getElementsByName(name.toString())[0];
		
		// case when canvas does not have image 
		// and user wants to add an image
		if(canvas.id == "Empty"){
			
			// create new image 
			image = new Image(250,250);
			url = prompt("Enter image url");
			image.src=url;
			images.push([image,name.toString()]);
		

			canvas.id="hasImage";
		
		}
		
		// case when canvas has image on it 
		// and wants to delete an image
		else if(canvas.id == "hasImage"){
		
			deleteImage = confirm("Do you want to delete this image?");
			
			if(deleteImage){
			
				// delete image entry from array of images 
				for(i=0;i<=images.length-1;i++){
				
					// delete entry into images 
					if(images[i][1] == name.toString()){
						images[i]="";
					
					}
			
				}
			
				canvas.id="Empty";
			
			}
		}
	}
	
	function init(){
		
		// redraw images on the gallery every 10 milliseconds 
		setInterval(updateTable,10);
	
	}
	
	function updateTable(){
		
		// draw any images that have been added to gallery
		for(name=1;name<=100;name++){
			
			canvas = document.getElementsByName(name.toString())[0];
			context = canvas.getContext('2d');
			
			if(canvas.id == "hasImage"){
				
				
				// find the image that was supposed to be draw on that canvas 
				for(i=0;i<=images.length-1;i++){
					
					if(images[i][1] == name.toString()){
						context.drawImage(images[i][0],0,0,canvas.width,canvas.height);
					
					}
					
				
				}
			}
			
			else if(canvas.id == "Empty"){
				
				context.fillStyle="white";
				context.fillRect(0,0,canvas.width,canvas.height);
			
			}
		}
	}
	
	// start updating table when window loads 
	window.onload = init;
		
			
  </script>
</body>
</html>
